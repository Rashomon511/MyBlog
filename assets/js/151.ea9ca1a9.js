(window.webpackJsonp=window.webpackJsonp||[]).push([[151],{269:function(n,s,e){"use strict";e.r(s);var a=e(0),t=Object(a.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"react中key的属性和用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#react中key的属性和用法","aria-hidden":"true"}},[n._v("#")]),n._v(" react中key的属性和用法")]),n._v(" "),e("p",[n._v("在代码中，我们很容易忽略react中的key值，当我们动态的生产react元素时。并且这个元素包含多个且不确定时，\n如果没有key值，浏览器就会警告\n")]),n._v(" "),e("blockquote",[e("p",[n._v('Warning: Each child in an array or iterator should have a unique "key" prop.\n例如：')])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("  renderProduct = () => {\n    const { application: { product } } = this.props;\n    return product.map(\n      item => <Option value={item.id}>{item.productName}</Option>);\n  };\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br")])]),e("p",[n._v("这时我们就需要key这个属性, 这里的key具有唯一性，")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("  renderProduct = () => {\n    const { application: { product } } = this.props;\n    return product.map(\n      item => <Option value={item.id} key={item.id}>{item.productName}</Option>);\n  };\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br")])]),e("p",[n._v("我们知道当组件的属性发生了变化，其 render 方法会被重新调用，组件会被重新渲染。\n那么，为数组中的元素传一个唯一的 key（比如ID），就很好地解决了这个问题。React 比较更新前后的元素 key 值，如果相同则更新，如果不同则销毁之前的，重新创建一个元素。")]),n._v(" "),e("p",[n._v("那么有人会问，为什么只有数组中的元素需要有唯一的 key，而其他的元素（比如上面的")]),e("h3",[n._v("用户列表")]),n._v("）则不需要呢？答案是：React 有能力辨别出，更新前后元素的对应关系。\n这一点，也许直接看 JSX 不够明显，看 Babel 转换后的 React.createElement 则清晰很多"),e("p"),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('// 转换前\nconst element = (\n  <div>\n    <h3>example</h3>\n    {[<p key={1}>hello</p>, <p key={2}>world</p>]}\n  </div>\n);\n\n// 转换后\n"use strict";\n\nvar element = React.createElement(\n  "div",\n  null,\n  React.createElement("h3",null,"example"),\n  [\n    React.createElement("p",{ key: 1 },"hello"),\n    React.createElement("p",{ key: 2 },"world")\n  ]\n);\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br")])]),e("p",[n._v("不管 props 如何变化，数组外的每个元素始终出现在 React.createElement() 参数列表中的固定位置，这个位置就是天然的 key。")]),n._v(" "),e("p",[n._v("那我们可以在哪里用上key呢？")]),n._v(" "),e("blockquote",[e("p",[n._v("也就是需要动态渲染的子组件上用\n在项目中，该表单由多个相同的表单子组件组成，\n"),e("img",{attrs:{src:"/img/reactkey/key.jpeg",alt:""}})])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('  renderEnvForm = (formItemLayout, env) => {\n    const { getFieldDecorator } = this.props.form;\n    const { keys, change } = this.state;\n    const forItem = keys.map((k) => {\n      return (\n        <FormItem\n          {...formItemLayout}\n          label="软件环境"\n          required={false}\n          key={k}\n        >\n          {getFieldDecorator(`envId[${k}]`, {\n            rules: [{ required: true, message: \'请输入\' }],\n            initialValue: !change ? this.getInitialValue(k) : \'\',\n          })(\n            <Select\n              showSearch\n              placeholder="请选择软件环境"\n              disabled={env.length === 0}\n              style={{ width: \'78%\' }}\n              filterOption={(input, option) =>\n                option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0}\n            >\n              {this.renderWebEnv(env)}\n            </Select>\n          )}\n          <Icon\n            style={{ marginLeft: 10 }}\n            type="plus-circle-o"\n            disabled={keys.length === 1}\n            onClick={() => this.add()}\n          />\n          <Icon\n            style={{ marginLeft: 10 }}\n            type="minus-circle-o"\n            disabled={keys.length === 1}\n            onClick={() => this.remove(k)}\n          />\n        </FormItem>\n      );\n    });\n    return forItem;\n  };\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br")])]),e("p",[n._v("每个组件都有唯一的key值，但组件产生变化时，react可以根据key值来判断渲染哪一个组件，从而导致不出错。")])])}),[],!1,null,null,null);s.default=t.exports}}]);